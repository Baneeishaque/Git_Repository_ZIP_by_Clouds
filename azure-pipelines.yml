parameters:
- name: image
  displayName: Pool Image
  type: string
  default: windows-latest
  values:
  - windows-latest
  - ubuntu-latest

trigger: none

pool:
  vmImage: ${{ parameters.image }}

# Variables
variables:
  hosting_provider: github.com
  owner: odoo
  repository: odoo

steps:

- checkout: self
  fetchDepth: 1

# Check for Git
- script: git --version
  displayName: 'Check for Git'

# Clone Repository & Verify Clone
- script: |
    git clone https://$(hosting_provider)/$(owner)/$(repository).git
    echo 
    echo Repository Contents
    echo --------------------------------------------------------
    ls -all $(repository)
  displayName: 'Clone Repository'

# Check for Zip
- script: zip --version
  displayName: 'Check for Zip'

# Compress Repository & Verify Compress
- script: |
    zip -r $(repository).zip $(repository) 
    echo 
    echo Current Directory Contents
    echo --------------------------------------------------------
    ls
  displayName: 'Zip Repository'

- publish: '$(repository).zip'
  artifact: '$(owner)_$(repository)_${{ parameters.image }}'
